@using Microsoft.AspNetCore.Builder
@using Microsoft.AspNetCore.Localization
@using Microsoft.AspNetCore.Mvc.Localization
@using Microsoft.Extensions.Options
@inject PhoneStore.Web.Resources.LocService L
@inject IViewLocalizer Localizer
@inject IOptions<RequestLocalizationOptions> LocOptions
@using PhoneStore.Web.Resources
@inject LocService SharedLocalizer
@{
    var current = System.Threading.Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName;
    string url = "";
    var requestCulture = Context.Features.Get<IRequestCultureFeature>();
    var cultureItems = LocOptions.Value.SupportedUICultures
        .Select(c => new SelectListItem { Value = c.Name, Text = L[c.TwoLetterISOLanguageName] })
        .ToList();
    var context = Context.Request;
    @*This line get the current page url value*@
    var queryString = context.QueryString.Value;
    if (queryString == null || queryString == "")
    {
        url = context.Path;
    }
    else
    {
        url = context.Path  + queryString;
    }
}
<!--begin::Menu toggle-->
<a href="#" class="btn btn-icon btn-color-white btn-active-color-primary btn-outline btn-active-bg-light w-30px h-30px w-lg-40px h-lg-40px" data-kt-menu-trigger="{default:'click', lg: 'hover'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
    @L[current]
</a>
<!--begin::Menu toggle-->
<!--begin::Menu-->
<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-title-gray-700 menu-icon-muted menu-active-bg menu-state-color fw-semibold py-4 fs-base w-150px" data-kt-menu="true" data-kt-element="theme-mode-menu">
    <!--begin::Menu item-->
    <div class="menu-item px-3 my-0">
        <a asp-action="SetLanguage" asp-controller="Language"  asp-route-culture="ps-AF" asp-route-returnUrl="@url" class="menu-link px-3 py-2">

            <span class="menu-title">@L["Pashto"]</span>
        </a>
    </div>
    <!--end::Menu item-->
    <!--begin::Menu item-->
    <div class="menu-item px-3 my-0">
        <a asp-action="SetLanguage" asp-controller="Language" asp-route-culture="fa" asp-route-returnUrl="@url" class="menu-link px-3 py-2">

            <span class="menu-title">@L["Dari"]</span>
        </a>
    </div>
    <!--end::Menu item-->
    <!--begin::Menu item-->
    <div class="menu-item px-3 my-0">
        <a asp-action="SetLanguage" asp-controller="Language"  asp-route-culture="en-US" asp-route-returnUrl="@url" class="menu-link px-3 py-2">

            <span class="menu-title">@L["English"]</span>
        </a>
    </div>
    <!--end::Menu item-->
</div>
<!--end::Menu-->